# System Architecture Diagram

```
                                         ┌─────────────────┐
                                         │    Internet     │
                                         └────────┬────────┘
                                                  │
                                                  ▼
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│  AWS Cloud (ap-northeast-2)                                                             │
│                                                                                         │
│  ┌───────────────────────────────────────────────────────────────────────────────────┐  │
│  │  VPC: tf-ticketing-prod-vpc (10.0.0.0/16)                                         │  │
│  │                                                                                   │  │
│  │  ┌─────────────────────────────────────────────────────────────────────────────┐  │  │
│  │  │  Public Subnet: tf-ticketing-prod-sub (10.0.1.0/24) [ap-northeast-2a]       │  │  │
│  │  │                                                                             │  │  │
│  │  │  ┌───────────────────────────────────────────────────────────────────────┐  │  │  │
│  │  │  │  EC2: tf-ticketing-prod-ec2 (t3.small, Ubuntu 22.04)                  │  │  │  │
│  │  │  │                                                                       │  │  │  │
│  │  │  │  ┌─────────────────────────────────────────────────────────────────┐  │  │  │  │
│  │  │  │  │  Docker Containers                                              │  │  │  │  │
│  │  │  │  │                                                                 │  │  │  │  │
│  │  │  │  │  ┌─────────┐                                                    │  │  │  │  │
│  │  │  │  │  │  Nginx  │ ─── Reverse Proxy                                  │  │  │  │  │
│  │  │  │  │  │  :80    │                                                    │  │  │  │  │
│  │  │  │  │  └────┬────┘                                                    │  │  │  │  │
│  │  │  │  │       │                                                         │  │  │  │  │
│  │  │  │  │       ├──────────────────┬──────────────────┐                   │  │  │  │  │
│  │  │  │  │       ▼                  ▼                  ▼                   │  │  │  │  │
│  │  │  │  │  ┌─────────┐        ┌─────────┐       ┌──────────┐              │  │  │  │  │
│  │  │  │  │  │ NextJS  │        │ Spring  │       │Prometheus│              │  │  │  │  │
│  │  │  │  │  │ :3000   │        │ :8080   │       │  :9090   │              │  │  │  │  │
│  │  │  │  │  └─────────┘        └────┬────┘       └────┬─────┘              │  │  │  │  │
│  │  │  │  │                          │                 │                    │  │  │  │  │
│  │  │  │  │                          ▼                 ▼                    │  │  │  │  │
│  │  │  │  │                    ┌──────────┐       ┌─────────┐               │  │  │  │  │
│  │  │  │  │                    │PostgreSQL│       │ Grafana │               │  │  │  │  │
│  │  │  │  │                    │  :5432   │       │ :3001   │               │  │  │  │  │
│  │  │  │  │                    └──────────┘       └─────────┘               │  │  │  │  │
│  │  │  │  │                    ┌──────────┐                                 │  │  │  │  │
│  │  │  │  │                    │  Redis   │                                 │  │  │  │  │
│  │  │  │  │                    │  :6379   │                                 │  │  │  │  │
│  │  │  │  │                    └──────────┘                                 │  │  │  │  │
│  │  │  │  └─────────────────────────────────────────────────────────────────┘  │  │  │  │
│  │  │  │                                                                       │  │  │  │
│  │  │  │  [Root Volume: 20GB gp3]                                              │  │  │  │
│  │  │  └───────────────────────────────────────────────────────────────────────┘  │  │  │
│  │  │                                                                             │  │  │
│  │  └─────────────────────────────────────────────────────────────────────────────┘  │  │
│  │                                                                                   │  │
│  └───────────────────────────────────────────────────────────────────────────────────┘  │
│                                             │                                           │
│                                    ┌────────┴────────┐                                  │
│                                    │ Internet Gateway│                                  │
│                                    │tf-ticketing-prod│                                  │
│                                    │      -igw       │                                  │
│                                    └────────┬────────┘                                  │
│                                             │                                           │
│  ┌──────────────────────────────────────────┼────────────────────────────────────────┐  │
│  │                                          │                                        │  │
│  │  ┌─────────────────────┐    ┌────────────┴───────────┐    ┌────────────────────┐  │  │
│  │  │ Elastic IP          │    │ Route Table            │    │ Security Group     │  │  │
│  │  │ tf-ticketing-prod   │    │ tf-ticketing-prod-rt   │    │ tf-ticketing-prod  │  │  │
│  │  │ -eip                │    │                        │    │ -web-sg            │  │  │
│  │  │                     │    │ ┌──────────┬─────────┐ │    │                    │  │  │
│  │  │ ● Public IP ────────┼────┤ │Dest      │Target   │ │    │ Inbound:           │  │  │
│  │  │   attached to EC2   │    │ ├──────────┼─────────┤ │    │  ● 80  (HTTP)      │  │  │
│  │  │                     │    │ │0.0.0.0/0 │   IGW   │ │    │  ● 443 (HTTPS)     │  │  │
│  │  │                     │    │ │10.0.0.0/16│ local  │ │    │                    │  │  │
│  │  │                     │    │ └──────────┴─────────┘ │    │ Outbound:          │  │  │
│  │  │                     │    │                        │    │  ● All traffic     │  │  │
│  │  └─────────────────────┘    └────────────────────────┘    └────────────────────┘  │  │
│  │                                                                                   │  │
│  └───────────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                         │
│  ┌──────────────────────────────────────┐    ┌────────────────────────────────────┐     │
│  │ IAM                                  │    │ CodeDeploy                         │     │
│  │                                      │    │                                    │     │
│  │ ● Instance Profile (SSM access)     │    │ ● Application                      │     │
│  │ ● CodeDeploy Service Role           │    │ ● Deployment Group (EC2 tag-based) │     │
│  └──────────────────────────────────────┘    └────────────────────────────────────┘     │
│                                                                                         │
│  ┌──────────────────────────────────────┐                                               │
│  │ Systems Manager                      │                                               │
│  │                                      │                                               │
│  │ ● Session Manager (SSH 대체)         │                                               │
│  └──────────────────────────────────────┘                                               │
│                                                                                         │
└─────────────────────────────────────────────────────────────────────────────────────────┘


  External Services (CI/CD)
  ─────────────────────────
  GitHub ──▶ GitHub Actions ──▶ Docker Hub
                    │
                    ▼
              CodeDeploy Agent (on EC2)
```

## Resource Summary

| Resource | Name | Spec |
|----------|------|------|
| VPC | tf-ticketing-prod-vpc | 10.0.0.0/16 |
| Subnet | tf-ticketing-prod-sub | 10.0.1.0/24 (Public, ap-northeast-2a) |
| EC2 | tf-ticketing-prod-ec2 | t3.small, Ubuntu 22.04, 20GB gp3 |
| Elastic IP | tf-ticketing-prod-eip | Attached to EC2 |
| Security Group | tf-ticketing-prod-web-sg | IN: 80, 443 / OUT: All |
| Internet Gateway | tf-ticketing-prod-igw | - |
| Route Table | tf-ticketing-prod-rt | 0.0.0.0/0 → IGW |

## Network Flow

```
User Request
     │
     ▼
[Elastic IP] ──▶ [IGW] ──▶ [Route Table] ──▶ [Security Group] ──▶ [EC2:Nginx:80]
                                                                       │
                                                    ┌──────────────────┼──────────────────┐
                                                    ▼                  ▼                  ▼
                                               [NextJS:3000]    [Spring:8080]    [Prometheus:9090]
                                                                      │                   │
                                                              ┌───────┴───────┐           ▼
                                                              ▼               ▼      [Grafana:3001]
                                                       [PostgreSQL:5432] [Redis:6379]
```
